{% extends 'base.html' %}
{% load static %}

{% block head %}
<link 
  rel="stylesheet"
  type="text/css"
  href="{% static 'css/launches/launch-index.css' %}"
/>
{% endblock %}

{% block content %}

<section class="page-header">
  <h1>Launch List</h1>
  <img src="{% static 'images/launching.svg' %}" alt="load" />
  <img src="{% static 'images/launching.svg' %}" alt="load" />
  <img src="{% static 'images/launching.svg' %}" alt="load" />
  <img src="{% static 'images/launching.svg' %}" alt="load" />
</section>

<section class="card-container">
  {% for launch in launches %}
  <div class="card">
    <div class="card-content">
      <div class="card-img-container">
        <a href="{% url 'launch-detail' launch.id %}" class="card-trigger" data-launch-id="{{ launch.id }}">
          {% if launch.photo.url %}
            <img 
              id="launch-img-{{ launch.id }}"
              src="{{launch.photo.url}}" 
              alt="A photo of {{launch.name}}"
              class="usr-img"
            >
          {% else %}
            <img 
              id="launch-img-{{ launch.id }}"
              src="{% static 'images/launching.svg' %}" 
              alt="load"
            >
          {% endif %}
        </a>
      </div>
      <h2 class="card-title">{{ launch.mission|upper }}</h2>
      <p>{{ launch.model|capfirst }} Rocket</p>
      <p><small>Orbit: {{ launch.orbit }}</small></p>
      <p><small>{{ launch.description }}</small></p>
      <a href="{% url 'launch-detail' launch.id %}" 
          class="card-link" 
          data-launch-id="{{ launch.id }}">
          Learn More
      </a>
    </div>
  </div>
  {% endfor %}
  

<script>
  document.querySelectorAll('.card-trigger').forEach(trigger => {
    trigger.addEventListener('click', function(e) {
      e.preventDefault(); // prevent navigating immediately
      var launchId = this.dataset.launchId; // get the launch id
      var img = document.getElementById('launch-img-' + launchId); // find the image
      img.src = "{% static 'images/launch-tracker-animation-once.gif' %}"; // switch the image src
      setTimeout(function() {
        window.location.href = trigger.href; // navigate to the href after 4 seconds
      }, 4000);
    });
  });
</script>



</section>

{% endblock %}